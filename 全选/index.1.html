<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div id="app">


    </div>
    <script src="js/vue.min.js"></script>
    <script src="js/vuex.min.js"></script>
    <script src="js/data.js"></script>
    <script>
var local = new Local();
var {mapActions,mapState}  = Vuex

Vue.use(Vuex);
var store=new Vuex.Store({
    state:{arr:[]},
    mutations:{
        getData(state,pyload){
            state.arr = [...pyload.arr];
        },
        del(state,pyload){
           
        }
    },
    actions:{
        getData({commit},pyload){
            var data = local.getData()
            commit("getData",{arr:data});
        },
        del({commit,dispatch},pyload){
            if(!pyload.id) console.log("出错了")
            local.delDate(pyload.id);
            dispatch("getData");
            
        }
    }
})

function DataCtr(){
}
DataCtr.prototype.find=function(data,id){
    return data.find(e=>e.id==id);
}
DataCtr.prototype.remove = function(data,id){
    var {id,...rest} =data;
    data =rest;
}
dataCtr = new DataCtr();

    new Vue({
        el:"#app",
        template:`
        <div>
        <ul>
            <li :key="item.id" v-for="item,index in arr">
                <input 
                type="checkbox"
                @change="change($event,item.id)" 
                v-bind:checked=collect(item.id,item)>{{item.price}} 
                <button @click="delDbule(item.id)">删除</button>
            </li>
        </ul>
        
        </div>
        `,
        methods: {
            ...mapActions(["getData","del"]),
            collect(id,item){
                this.arr1[id] = Object.assign({},item)
                this.arr1[id].c = false;
            },
            change(e,id){
                this.arr1[id].c = e.target.checked;
                console.log(this.arr1);
            },
            delDbule(id){
                this.del({id:id})
                console.log(id);
                var {id,...rest} = this.arr1;
                console.log(rest,"rest");
                console.log(id);
                this.arr1 = rest;
            }
        },
        computed: {
            ...mapState(['arr'])
        },
        store,
        created () {
            this.getData()
        },
        data(){
            return{
                arr1:[]
            }
        }
    })
    </script>
</body>
</html>